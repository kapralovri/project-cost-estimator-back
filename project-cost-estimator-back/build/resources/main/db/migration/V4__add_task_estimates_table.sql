-- Создаем таблицу task_estimates
CREATE TABLE task_estimates (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    task_id BIGINT NOT NULL,
    role VARCHAR(50) NOT NULL,
    min_value DECIMAL(19,2) NOT NULL DEFAULT 0,
    real_value DECIMAL(19,2) NOT NULL DEFAULT 0,
    max_value DECIMAL(19,2) NOT NULL DEFAULT 0,
    CONSTRAINT fk_task_estimates_task FOREIGN KEY (task_id)
        REFERENCES tasks(id) ON DELETE CASCADE
);

-- Создаем индексы для оптимизации запросов
CREATE INDEX idx_task_estimates_task ON task_estimates(task_id);
CREATE INDEX idx_task_estimates_role ON task_estimates(task_id, role);
