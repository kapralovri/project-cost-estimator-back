CREATE TABLE estimates (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    project_name VARCHAR(255) NOT NULL,
    client VARCHAR(255),
    currency VARCHAR(16) DEFAULT 'USD' NOT NULL,
    total_cost DECIMAL(19,2) DEFAULT 0 NOT NULL,
    created_at TIMESTAMP NOT NULL,
    updated_at TIMESTAMP NOT NULL
);

CREATE TABLE estimate_items (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    estimate_id BIGINT NOT NULL,
    role VARCHAR(128) NOT NULL,
    hours DECIMAL(19,2) NOT NULL,
    rate DECIMAL(19,2) NOT NULL,
    cost DECIMAL(19,2) NOT NULL,
    CONSTRAINT fk_items_estimate FOREIGN KEY (estimate_id)
        REFERENCES estimates(id) ON DELETE CASCADE
);

CREATE INDEX idx_items_estimate ON estimate_items(estimate_id);


